/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"2e3e9a4314a4d6938b16.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){var e;function t(){var e,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function a(t,o,i,c){var a=o&&o.prototype instanceof s?o:s,l=Object.create(a.prototype);return n(l,"_invoke",function(t,n,o){var i,c,a,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,a=e,p.n=n,u}};function d(t,n){for(c=t,a=n,r=0;!f&&s&&!o&&r<l.length;r++){var o,i=l[r],d=p.p,y=i[2];t>3?(o=y===n)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=t<2&&d<i[1])?(c=0,p.v=n,p.n=i[1]):d<y&&(o=t<3||i[0]>n||n>y)&&(i[4]=t,i[5]=n,p.n=y,c=0))}if(o||t>1)return u;throw f=!0,n}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,a=y;(r=c<2?e:a)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,a)):p.n=a:p.v=a);try{if(s=2,i){if(c||(o="next"),r=i[o]){if(!(r=r.call(i,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,c<2&&(c=0)}else 1===c&&(r=i.return)&&r.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((r=(f=p.n<0)?a:t.call(n,p))!==u)break}catch(t){i=e,c=1,a=t}finally{s=1}}return{value:r,done:f}}}(t,i,c),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][i]?r(r([][i]())):(n(r={},i,function(){return this}),r),d=f.prototype=s.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,n(e,c,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,n(d,"constructor",f),n(f,"constructor",l),l.displayName="GeneratorFunction",n(f,c,"GeneratorFunction"),n(d),n(d,c,"Generator"),n(d,i,function(){return this}),n(d,"toString",function(){return"[object Generator]"}),(t=function(){return{w:a,m:y}})()}function n(e,t,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,r,o){function c(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(c("next",0),c("throw",1),c("return",2))},n(e,t,r,o)}function r(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var c=e.apply(t,n);function a(e){r(c,o,i,a,u,"next",e)}function u(e){r(c,o,i,a,u,"throw",e)}a(void 0)})}}var i,c,a,u,s,l,f,p,d,y,m,v="undefined"!=typeof process&&(null===(e=process.env)||void 0===e?void 0:"https://aurora-omega.vercel.app")||"https://aurora-omega.vercel.app",h=null,g=null;function b(){return w.apply(this,arguments)}function w(){return(w=o(t().m(function e(){var n,r,o,i,c,l;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=a.value.trim(),r=u.value,n&&r){e.n=1;break}return k("Veuillez remplir tous les champs"),e.a(2);case 1:return s.disabled=!0,s.textContent="Connexion...",x(),e.p=2,e.n=3,fetch("".concat(v,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return i=e.v,e.n=4,i.json();case 4:if(c=e.v,i.ok){e.n=5;break}throw new Error(c.error||"Erreur de connexion");case 5:h=c.token||"session",g=(null===(o=c.user)||void 0===o?void 0:o.name)||n.split("@")[0],localStorage.setItem("aurora_token",h),localStorage.setItem("aurora_user",g),S(),e.n=7;break;case 6:e.p=6,k((l=e.v)instanceof Error?l.message:"Erreur de connexion");case 7:return e.p=7,s.disabled=!1,s.textContent="Se connecter",e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}))).apply(this,arguments)}function E(){h=null,g=null,localStorage.removeItem("aurora_token"),localStorage.removeItem("aurora_user"),i.style.display="block",c.style.display="none",a.value="",u.value=""}function S(){i.style.display="none",c.style.display="block",p.textContent=g||"Utilisateur"}function k(e){l.textContent=e,l.style.display="block"}function x(){l.style.display="none"}function I(e){y.textContent=e,y.style.display="block",m.style.display="none",setTimeout(function(){y.style.display="none"},5e3)}function T(e){m.textContent=e,m.style.display="block",y.style.display="none",setTimeout(function(){m.style.display="none"},3e3)}function O(e){d.style.display=e?"flex":"none",document.querySelectorAll(".aurora-action-btn").forEach(function(t){return t.disabled=e})}function j(){return(j=o(t().m(function e(n){var r,o,i,c;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return O(!0),y.style.display="none",m.style.display="none",e.p=1,e.n=2,B();case 2:if((r=e.v)||"continue-writing"===n){e.n=3;break}throw new Error("Veuillez sélectionner du texte dans le document");case 3:return e.n=4,fetch("".concat(v,"/api/ai/format"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)},credentials:"include",body:JSON.stringify({action:n,content:r,selection:r})});case 4:return o=e.v,e.n=5,o.json();case 5:if(i=e.v,o.ok){e.n=6;break}throw new Error(i.error||"Erreur lors du traitement");case 6:if(!i.result){e.n=8;break}return e.n=7,C(i.result);case 7:T("Texte mis à jour avec succès !");case 8:e.n=10;break;case 9:e.p=9,I((c=e.v)instanceof Error?c.message:"Erreur inconnue");case 10:return e.p=10,O(!1),e.f(10);case 11:return e.a(2)}},e,null,[[1,9,10,11]])}))).apply(this,arguments)}function B(){return _.apply(this,arguments)}function _(){return _=o(t().m(function e(){return t().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=o(t().m(function e(n){var r;return t().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.getSelection()).load("text"),e.n=1,n.sync();case 1:return e.a(2,r.text)}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),_.apply(this,arguments)}function C(e){return P.apply(this,arguments)}function P(){return P=o(t().m(function e(n){return t().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=o(t().m(function e(r){return t().w(function(e){for(;;)switch(e.n){case 0:return r.document.getSelection().insertText(n,Word.InsertLocation.replace),e.n=1,r.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),P.apply(this,arguments)}Office.onReady(function(e){e.host===Office.HostType.Word&&function(){i=document.getElementById("login-section"),c=document.getElementById("main-panel"),a=document.getElementById("email"),u=document.getElementById("password"),s=document.getElementById("login-btn"),l=document.getElementById("login-error"),f=document.getElementById("logout-btn"),p=document.getElementById("user-name"),d=document.getElementById("loading-indicator"),y=document.getElementById("action-error"),m=document.getElementById("action-success"),s.addEventListener("click",b),f.addEventListener("click",E),document.querySelectorAll(".aurora-action-btn").forEach(function(e){e.addEventListener("click",function(){var t=e.dataset.action;t&&function(e){j.apply(this,arguments)}(t)})});var e=localStorage.getItem("aurora_token"),t=localStorage.getItem("aurora_user");e&&t&&(h=e,g=t,S())}()})}(),function(){"use strict";new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map