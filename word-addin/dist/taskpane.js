/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var t={58394:function(t,e,n){"use strict";t.exports=n.p+"2e3e9a4314a4d6938b16.css"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function t(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function a(t,o,i,c){var a=o&&o.prototype instanceof s?o:s,l=Object.create(a.prototype);return e(l,"_invoke",function(t,e,o){var i,c,a,s=0,l=o||[],f=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return i=t,c=0,a=n,p.n=e,u}};function d(t,e){for(c=t,a=e,r=0;!f&&s&&!o&&r<l.length;r++){var o,i=l[r],d=p.p,y=i[2];t>3?(o=y===e)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=d&&((o=t<2&&d<i[1])?(c=0,p.v=e,p.n=i[1]):d<y&&(o=t<3||i[0]>e||e>y)&&(i[4]=t,i[5]=e,p.n=y,c=0))}if(o||t>1)return u;throw f=!0,e}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,a=y;(r=c<2?n:a)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,a)):p.n=a:p.v=a);try{if(s=2,i){if(c||(o="next"),r=i[o]){if(!(r=r.call(i,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,c<2&&(c=0)}else 1===c&&(r=i.return)&&r.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((r=(f=p.n<0)?a:t.call(e,p))!==u)break}catch(t){i=n,c=1,a=t}finally{s=1}}return{value:r,done:f}}}(t,i,c),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][i]?r(r([][i]())):(e(r={},i,function(){return this}),r),d=f.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,c,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,e(d,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,c,"GeneratorFunction"),e(d),e(d,c,"Generator"),e(d,i,function(){return this}),e(d,"toString",function(){return"[object Generator]"}),(t=function(){return{w:a,m:y}})()}function e(t,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,n,r,o){function c(n,r){e(t,n,function(t){return this._invoke(n,r,t)})}n?i?i(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r:(c("next",0),c("throw",1),c("return",2))},e(t,n,r,o)}function n(t,e,n,r,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var c=t.apply(e,r);function a(t){n(c,o,i,a,u,"next",t)}function u(t){n(c,o,i,a,u,"throw",t)}a(void 0)})}}var o,i,c,a,u,s,l,f,p,d,y,m="https://aurora-omega.vercel.app.com",h=null,v=null;function g(){return b.apply(this,arguments)}function b(){return(b=r(t().m(function e(){var n,r,o,i,s,l;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n=c.value.trim(),r=a.value,n&&r){t.n=1;break}return S("Veuillez remplir tous les champs"),t.a(2);case 1:return u.disabled=!0,u.textContent="Connexion...",k(),t.p=2,t.n=3,fetch("".concat(m,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return i=t.v,t.n=4,i.json();case 4:if(s=t.v,i.ok){t.n=5;break}throw new Error(s.error||"Erreur de connexion");case 5:h=s.token||"session",v=(null===(o=s.user)||void 0===o?void 0:o.name)||n.split("@")[0],localStorage.setItem("aurora_token",h),localStorage.setItem("aurora_user",v),E(),t.n=7;break;case 6:t.p=6,S((l=t.v)instanceof Error?l.message:"Erreur de connexion");case 7:return t.p=7,u.disabled=!1,u.textContent="Se connecter",t.f(7);case 8:return t.a(2)}},e,null,[[2,6,7,8]])}))).apply(this,arguments)}function w(){h=null,v=null,localStorage.removeItem("aurora_token"),localStorage.removeItem("aurora_user"),o.style.display="block",i.style.display="none",c.value="",a.value=""}function E(){o.style.display="none",i.style.display="block",f.textContent=v||"Utilisateur"}function S(t){s.textContent=t,s.style.display="block"}function k(){s.style.display="none"}function x(t){d.textContent=t,d.style.display="block",y.style.display="none",setTimeout(function(){d.style.display="none"},5e3)}function I(t){y.textContent=t,y.style.display="block",d.style.display="none",setTimeout(function(){y.style.display="none"},3e3)}function T(t){p.style.display=t?"flex":"none",document.querySelectorAll(".aurora-action-btn").forEach(function(e){return e.disabled=t})}function O(){return(O=r(t().m(function e(n){var r,o,i,c;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return T(!0),d.style.display="none",y.style.display="none",t.p=1,t.n=2,j();case 2:if((r=t.v)||"continue-writing"===n){t.n=3;break}throw new Error("Veuillez sélectionner du texte dans le document");case 3:return t.n=4,fetch("".concat(m,"/api/ai/format"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)},credentials:"include",body:JSON.stringify({action:n,content:r,selection:r})});case 4:return o=t.v,t.n=5,o.json();case 5:if(i=t.v,o.ok){t.n=6;break}throw new Error(i.error||"Erreur lors du traitement");case 6:if(!i.result){t.n=8;break}return t.n=7,_(i.result);case 7:I("Texte mis à jour avec succès !");case 8:t.n=10;break;case 9:t.p=9,x((c=t.v)instanceof Error?c.message:"Erreur inconnue");case 10:return t.p=10,T(!1),t.f(10);case 11:return t.a(2)}},e,null,[[1,9,10,11]])}))).apply(this,arguments)}function j(){return B.apply(this,arguments)}function B(){return B=r(t().m(function e(){return t().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=r(t().m(function e(n){var r;return t().w(function(t){for(;;)switch(t.n){case 0:return(r=n.document.getSelection()).load("text"),t.n=1,n.sync();case 1:return t.a(2,r.text)}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),B.apply(this,arguments)}function _(t){return C.apply(this,arguments)}function C(){return C=r(t().m(function e(n){return t().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=r(t().m(function e(r){return t().w(function(t){for(;;)switch(t.n){case 0:return r.document.getSelection().insertText(n,Word.InsertLocation.replace),t.n=1,r.sync();case 1:return t.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),C.apply(this,arguments)}Office.onReady(function(t){t.host===Office.HostType.Word&&function(){o=document.getElementById("login-section"),i=document.getElementById("main-panel"),c=document.getElementById("email"),a=document.getElementById("password"),u=document.getElementById("login-btn"),s=document.getElementById("login-error"),l=document.getElementById("logout-btn"),f=document.getElementById("user-name"),p=document.getElementById("loading-indicator"),d=document.getElementById("action-error"),y=document.getElementById("action-success"),u.addEventListener("click",g),l.addEventListener("click",w),document.querySelectorAll(".aurora-action-btn").forEach(function(t){t.addEventListener("click",function(){var e=t.dataset.action;e&&function(t){O.apply(this,arguments)}(e)})});var t=localStorage.getItem("aurora_token"),e=localStorage.getItem("aurora_user");t&&e&&(h=t,v=e,E())}()})}(),function(){"use strict";new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map